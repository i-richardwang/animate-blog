---
title: 简单构建岗位和技能知识图谱
description: 分享用ESCO数据和Neo4j图数据库构建岗位技能知识图谱，实现技能关系的可视化与分析
releaseDate: 2023-08-20
author:
  name: Richard Wang
  url: https://imrichard.com
---

在人力资源管理和组织发展领域，清晰地理解岗位需求与个体技能之间的匹配关系至关重要。知识图谱作为一种强大的数据组织和关联技术，为我们提供了一种新的视角来探索和管理人岗间的复杂联系。

本文将分享一个构建基于岗位和技能的知识图谱的实践思路，探讨如何利用公开数据源和图数据库技术，搭建一个初步的岗位-技能图谱，并探讨其在技能管理、人才发展等方面的潜在应用。

## 为什么选择知识图谱？

传统的岗位和技能管理方式，如使用电子表格或关系型数据库，往往难以直观地揭示岗位与技能之间、技能与技能之间的复杂关系。例如，我们很难快速回答"某岗位需要哪些核心技能？""掌握某项技能的人才可能适合哪些其他岗位？"等问题。

知识图谱通过**节点（Nodes）**和**关系（Relationships）**来建模现实世界中的实体及其联系，具有以下优势：

- **直观呈现复杂关系：** 能够清晰地展示岗位与技能的多对多关系，以及技能之间的层级或相似性。
- **灵活的查询与分析：** 支持复杂的关联查询，便于挖掘隐藏在数据背后的洞察。
- **良好的扩展性：** 易于融入新的数据维度，如经验要求、资格认证等。

## 核心构成要素

构建这样一个知识图谱，主要涉及以下几个方面：

1. **数据源选择：ESCO**  
   我们选用 ESCO (European Skills, Competences, Qualifications and Occupations) 作为主要数据来源。ESCO 是一个由欧盟委员会开发和维护的多语言分类体系，涵盖了欧洲劳动力市场中的技能、能力、资格和职业。它提供了相对标准化的职业描述、技能列表以及它们之间的关联，为我们构建图谱提供了坚实的数据基础。

2. **图数据库：Neo4j**  
   Neo4j 是一款主流的图数据库，它以图（Graph）的形式存储数据，天然适合处理实体间的复杂关系。其查询语言 Cypher 语法直观，易于上手。

3. **数据模型设计：**  
   在这个简化的模型中，我们主要关注两类核心实体（节点）和它们之间的关系：
   - **节点 (Node):**
     - `Occupation` (职业/岗位)
     - `Skill` (技能)
   - **关系 (Relationship):**
     - `ESSENTIAL_FOR` (某技能对于某职业是核心必需的)
     - `OPTIONAL_FOR` (某技能对于某职业是可选的或有益的)

## 构建步骤：数据导入与关系建立

接下来，我们通过 Neo4j 的 Cypher 语言将 ESCO 数据导入图数据库。假设我们已经将 ESCO 相关的职业、技能及它们之间的关系数据预处理并分别存储在 `occupations.csv`, `skills.csv`, 和 `occupationSkillRelations.csv` 文件中。

### 1. 导入职业数据 (Occupation Nodes)

```cypher
// 从 occupations.csv 文件加载数据
LOAD CSV WITH HEADERS FROM 'file:///occupations.csv' AS row
// 创建或匹配 Occupation 节点，以 conceptUri 作为唯一标识
MERGE (o:Occupation {conceptUri: row.conceptUri})
// 首次创建时，设置节点的属性
ON CREATE SET o.preferredLabel = row.preferredLabel, o.description = row.description
```

_解读：_ 这段 Cypher 代码会读取 `occupations.csv` 文件。对于每一行数据，它会尝试找到一个 `Occupation` 类型的节点，该节点的 `conceptUri` 属性与 CSV 文件中 `row.conceptUri` 的值相同。如果找不到，就会创建一个新的 `Occupation` 节点，并设置其 `preferredLabel` (职业名称) 和 `description` (描述) 属性。`conceptUri` 在 ESCO 中是每个职业的唯一标识符。

### 2. 导入技能数据 (Skill Nodes)

```cypher
// 从 skills.csv 文件加载数据
LOAD CSV WITH HEADERS FROM 'file:///skills.csv' AS row
// 创建或匹配 Skill 节点，以 conceptUri 作为唯一标识
MERGE (s:Skill {conceptUri: row.conceptUri})
// 首次创建时，设置节点的属性
ON CREATE SET s.preferredLabel = row.preferredLabel, s.description = row.description, s.skillType = row.skillType
```

_解读：_ 与导入职业数据类似，这段代码从 `skills.csv` 文件加载技能信息。同样使用 `conceptUri` 作为技能的唯一标识，创建 `Skill` 节点，并设置其 `preferredLabel` (技能名称)、`description` (描述) 和 `skillType` (技能类型) 等属性。

### 3. 建立技能与职业之间的关系

```cypher
// 从 occupationSkillRelations.csv 文件加载数据
LOAD CSV WITH HEADERS FROM 'file:///occupationSkillRelations.csv' AS row
// 匹配已存在的 Occupation 节点
MATCH (o:Occupation {conceptUri: row.occupationUri})
// 匹配已存在的 Skill 节点
MATCH (s:Skill {conceptUri: row.skillUri})
// 根据关系类型创建不同的关系
// 如果 relationType 是 'essential'，则创建 ESSENTIAL_FOR 关系
FOREACH (_ IN CASE WHEN row.relationType = 'essential' THEN [1] ELSE [] END |
    MERGE (s)-[:ESSENTIAL_FOR]->(o)
)
// 如果 relationType 是 'optional'，则创建 OPTIONAL_FOR 关系
FOREACH (_ IN CASE WHEN row.relationType = 'optional' THEN [1] ELSE [] END |
    MERGE (s)-[:OPTIONAL_FOR]->(o)
)
```

_解读：_ 这部分是构建图谱的核心。它读取包含职业和技能关联信息的 `occupationSkillRelations.csv` 文件。

- `MATCH` 子句用于根据 `occupationUri` 和 `skillUri` 找到之前已导入的职业和技能节点。
- `FOREACH` 和 `CASE WHEN` 结构用于根据 CSV 文件中 `relationType` 字段的值（"essential" 或 "optional"）来创建不同类型的关系。例如，如果一个技能对某个职业是核心的（essential），则在技能节点和职业节点之间创建一条 `ESSENTIAL_FOR` 的关系，方向从技能指向职业 (技能 `ESSENTIAL_FOR` 职业)。

完成以上步骤后，一个基础的岗位-技能知识图谱就构建完成了。

## 图谱探索与初步洞察

知识图谱的价值在于其可查询性和可视化。让我们来看一个简单的查询示例。

**查询与"数据(data)"相关的职业：**

作为数据从业者，我们可能想了解图谱中有哪些与"数据"相关的职业。

```cypher
MATCH (o:Occupation)
WHERE o.preferredLabel CONTAINS "data"
RETURN o.preferredLabel AS PreferredLabel
ORDER BY PreferredLabel // 添加排序使结果更易读
```

查询结果：

```
╒══════════════════════════════════════╕
│PreferredLabel                        │
╞══════════════════════════════════════╡
│"aviation data communications manager"│
├──────────────────────────────────────┤
│"big data archive librarian"          │
├──────────────────────────────────────┤
│"chief data officer"                  │
├──────────────────────────────────────┤
│"data analyst"                        │
├──────────────────────────────────────┤
│"data centre operator"                │
├──────────────────────────────────────┤
│"data entry clerk"                    │
├──────────────────────────────────────┤
│"data entry supervisor"               │
├──────────────────────────────────────┤
│"data protection officer"             │
├──────────────────────────────────────┤
│"data quality specialist"             │
├──────────────────────────────────────┤
│"data scientist"                      │
├──────────────────────────────────────┤
│"data warehouse designer"             │
├──────────────────────────────────────┤
│"database administrator"              │
├──────────────────────────────────────┤
│"database designer"                   │
├──────────────────────────────────────┤
│"database developer"                  │
├──────────────────────────────────────┤
│"database integrator"                 │
└──────────────────────────────────────┘
```

这个简单的查询帮助我们快速筛选出了一系列与数据处理、分析、管理相关的职业。

**可视化岗位与核心技能的关系：**

接下来，我们选取几个典型的数据相关职业，看看它们的核心技能（`ESSENTIAL_FOR` 关系）有何异同。

```cypher
MATCH (s:Skill)-[r:ESSENTIAL_FOR]->(o:Occupation)
WHERE o.preferredLabel IN [
    "data analyst",
    "data quality specialist",
    "data scientist",
    "database designer",
    "database developer"
]
RETURN o, r, s
```

在 Neo4j Browser 中执行此查询，可以得到类似下图的可视化结果：

![基于ESCO数据生成的若干数据职业（如数据科学家）及其核心技能要求的知识图谱网络图。](/images/docs/ai/occupationSkillRelationsgraph.svg)

**初步解读：**

通过图谱的可视化，我们可以直观地观察到：

- **技能重叠与独特性：** 不同岗位之间存在技能的共享（例如多个岗位都指向同一个技能节点），同时也各自拥有独特的技能要求。
- **岗位技能画像：**
  - 从图中可以看出，"**data scientist**"（数据科学家，右一）连接的独有核心技能（即未与其他展示岗位共享的技能）数量相对较多。这在一定程度上反映了该岗位对从业者技能广度和专业深度的要求。
  - 相比之下，"**data quality specialist**"（数据质量专员，中上）和"**data analyst**"（数据分析师，右下）的独有核心技能较少，其核心技能与其他岗位的重叠度更高。这可能意味着这些岗位的技能具有一定的普适性，也可能暗示着其从业者在特定方向上转岗或拓展职业路径时，与其他数据类岗位的技能壁垒相对较低。

**这种可视化的分析有助于我们：**

- 更清晰地理解不同岗位的核心竞争力。
- 识别关键技能和通用技能。
- 为人才盘点、招聘标准制定、培训体系设计提供参考。

## 知识图谱的价值与应用潜力

通过上述实践，我们构建了一个基础的岗位技能知识图谱。尽管简单，但它揭示了这种方法在人力资源管理中的一些潜在价值：

1. **清晰的技能画像：** 为每个岗位构建清晰、多维度的技能需求画像。
2. **技能差距分析：** 对比员工的技能与岗位要求，识别技能差距，指导培训发展。
3. **职业发展路径规划：** 通过分析技能的关联和进阶关系，为员工规划更合理的职业发展路径。
4. **精准招聘：** 基于详细的技能画像，更精确地定义招聘需求，筛选候选人。
5. **组织能力盘点：** 从宏观层面了解组织整体的技能储备情况。

## 图谱只是开始

用 ESCO 数据和 Neo4j 构建技能知识图谱，技术上是可行的。通过图结构，能直观地看到岗位和技能之间的关系，也能通过查询语句（如找到"需要Python技能的所有岗位"）快速获取洞察。

要在企业中真正发挥价值，还需要做很多事情：补充技能熟练度、经验年限等维度，融合企业内部的岗位体系和人才数据，甚至可以结合图算法来分析技能演进路径、识别关键技能缺口。图数据库提供了技术基础，但如何用好它，还需要结合具体的业务场景不断探索。
